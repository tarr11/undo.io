<% content_for :stylesheet_includes do %>
  <%= stylesheet_link_tag "task_folder"  %>
<% end %>
<% content_for :buttons do %>
    <%= button_to "New", {:controller => "task_folder", :action=>"new_file", :path=>(@path ||= '/'), :username=>current_user.username}, :class=>"btn primary"%>
<% end %>
<style>
.note-box {
  width: 300px;
  margin: 10px 10px 10px 10px;
  float: left;
  border:  solid black 1px;
  padding: 1em;
}

.note-container
{
    width:100%;
}
.undo-new-header
{
    list-style: none;
background-color: #5E87B0;
    text-shadow: 0 -1px 1px #254F7A;
border: 1px solid #456F9A;
padding: .5em .5em;
font-size: 14px;
font-weight: bold;
color: white;
margin-top: .2em;
border-image: initial;
}

.undo-new-header A:visited, .undo-new-header A:link
{
    color:white;
}


</style>
<script>
  $(function(){
  $('.note-container').masonry({
    // options
    itemSelector : '.note-box'

  });
});

</script>
<div class="content">
 <% unless @views.nil? %>
  <%= render 'task_folder/pill_views', :selected_view => params[:view]%>
 <% end %>
  <div class="note-container">
    <%@changed_files_by_folder.each do |folder_item|%>
    <div class="note-box">
       <ul style="margin-left:0">
         <%
            header_name = folder_item.first.nil? ? folder_item.second.first[:file].task_folder.shortName: folder_item.first
            if header_name.blank?
                header_name = "/"
            end

            if @wildcard_user_name
                user_name = "public"
            else
                user_name = folder_item.second.first[:file].user.username
            end
         %>
       <li class="undo-new-header"><%=link_to header_name, :controller => "task_folder", :action=>"folder_view", :username=>user_name , :path=>folder_item.second.first[:file].path%></li>
         <% folder_item.second.sort_by{|a| a[:file].revision_at}.reverse.each do |file| %>
      <%=render 'task_folder/note_item', :file=>file[:file], :changed_lines => file[:changedLines] %>
         <% end %>
       </ul>

     </div>
     <% end %>
  </div>
</div>
<div style="clear:both"></div>