<div class="header-path">
  <%= link_to "Home", :controller => "task_folder", :action=>"folder_view", :path=>"/"%>
  <% @path_parts.each do |part| %>
    <%= link_to part[:name], :controller => "task_folder", :action=>"folder_view", :path=>part[:path] %> /
<% end %>
  <% if !@file.nil? %>
      <%= link_to @file.shortName, :controller => "task_folder", :action=>"folder_view", :path=>@file.filename %>
    <%end%>
</div>
<div class="explorer">
<% if @folders.length > 0 %>
    <div class="column folder-column">
      <% @folders.each do |folder|%>

          <div class="box2">
               <div class="box-header">
                    <div class="filename" style="vertical-align: middle">
                     <%=image_tag("folder.png", :class => "icon-image")%>
                      <%= link_to folder.shortName, :controller => "task_folder", :action=>"folder_view", :path=>folder.path %>
                    </div>
                </div>
            </div>
          <% end %>

    </div>
<% end %>
<% if @files.length > 0 %>
      <div class="column file-column">
           <% @files.each do |file|%>
                <div class="box2">
                  <div class="box-header">
                        <div class="filename">
                          <%=image_tag("text-file-icon.png", :class => "icon-image")%>
                                <%= link_to file.shortName, :controller => "task_folder", :action=>"folder_view", :path=>file.filename%>
                          </div>
                  </div>
                </div>
            <% end %>
        <div class="box2">
              <div class="box-header">
                   <div class="filename" style="vertical-align: middle">
                    <%=image_tag("HashTag.png", :class => "icon-image")%>
                     <%= link_to "TODO", :controller => "task_folder", :action=>"folder_view", :path=>"TODO"%>
                   </div>
               </div>
           </div>

      </div>
 <% end %>
 </div>

<div class="column viewer-column">
<% if !@file.nil?%>
      <div id="editor-holder" class="contents file">
        <div class="file-header">
          <div class="file-actions">
                <%= link_to "edit", :controller => "todo_files", :action=>"edit", :id=>@file.id%>
          </div>
          <div class="file-header-name"><%=@file.filename%></div>
        </div>
        <div class="summary-content">
      <% @file.get_lines do |line|%>
            <div class="file-line"><%=line%></div>
      <% end %>
          </div>
        <div id="editor" class="ace-editor"><% @file.get_lines do |line|%><%=line%><% end %></div>
        </div>
<% end%>

 <% if @file.nil? %>
  <div class="contents summary">
    <div class="file-header">
      <div class="file-actions">
            <%= link_to "New", :controller => "todo_files", :action=>"new"%>
      </div>
      <div class="file-header-name"><%=@taskfolder.shortName%> Summary</div>
    </div>
    <div class="time-filter">
       <div class="time-range">When:</div>
        <% @ranges.each do |range|%>
      <div class="time-range"><%= link_to range[:name], :controller => "task_folder", :action=>"folder_view", :path=>params[:path], :end_date => range[:end_date], :start_date => range[:start_date] %></div>
    <% end %>
    </div>
    <div class="tasks-content">
      <table class="summary-table">
        <tr>
          <th>
          </th>
          <th>
            Note
          </th>
          <th>
            File
          </th>
          <th>
            Folder
          </th>
          <th>
            Date
          </th>
        </tr>
        <% @tasks.each do |task| %>
            <tr>
              <td><%=check_box_tag "complete"%></td>
              <td class="note"><%=task.contents%></td>
              <td><%=task.file.shortName%></td>
              <td><%=task.file.task_folder.name%></td>
              <td><%=task.file.revision_at.strftime("%m/%d/%Y")%></td>
            </tr>
          <% end %>
        <% @changed_folders.each do |folder| %>
            <% folder[:files].each do |file| %>
                <tr>
                  <td></td>
                  <td class="note">
                    <% file[:changes].first(1).each do |change| %>
                        <div><%=change%></div>
                    <% end %>
                      <% if file[:changes].length > 3 %>
                      <div class="change-line-count"><%=file[:number_of_lines] - 3%> more changes</div>
                      <% end %>
                    </ul>
                  </td>
                  <td>
                      <%= link_to  file[:name], :controller => "task_folder", :action=>"folder_view", :path=> file[:file].filename, :only_path => @only_path%>
                  </td>
                <td>
                  <%= link_to  folder[:name], :controller => "task_folder", :action=>"folder_view", :path=> folder[:name], :only_path => @only_path%>
                </td>
                  <td><%=file[:file].revision_at.strftime("%m/%d/%Y")%></td>
                </tr>
            <% end %>
        <% end %>

      </table>
    </div>
  </div>
 <% end %>
</div>
</div>

